<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?family=Epilogue:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900&display=swap"
    />
    <title>NourishQuest - Profile</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body
    class="bg-[#f8fbfb]"
    style="font-family: Epilogue, 'Noto Sans', sans-serif"
  >
    <div class="relative flex min-h-screen flex-col overflow-x-hidden">
      <!-- Header -->
      <header
        class="flex items-center justify-between border-b border-solid border-[#e8f3f2] px-10 py-3"
      >
        <div class="flex items-center gap-4 text-[#0e1b19]">
          <h2 class="text-lg font-bold leading-tight tracking-[-0.015em]">
            <a href="/" class="text-[#0e1b19]">NourishQuest</a>
          </h2>
        </div>
        <div class="flex flex-1 justify-end gap-8">
          <div class="flex items-center gap-4">
            <a class="text-[#0e1b19] text-sm font-medium" href="/profile"
              >My Profile</a
            >
            <a class="text-[#0e1b19] text-sm font-medium" href="/plan"
              >My Plan</a
            >
            <a class="text-[#0e1b19] text-sm font-medium" href="/foods"
              >Foods</a
            >
            <a class="text-[#0e1b19] text-sm font-medium" href="/leaderboard"
              >Leaderboards</a
            >
            <a class="text-[#0e1b19] text-sm font-medium" href="/achievements"
              >Achievements</a
            >
            <a class="text-[#0e1b19] text-sm font-medium" href="/dashboard"
              >Dashboard</a
            >
            <a class="text-[#0e1b19] text-sm font-medium" href="/recipes"
              >Recipes</a
            >
          </div>

          <!-- Log Out -->
          <form action="/logout" method="POST">
            <button
              type="submit"
              class="rounded-full h-10 px-4 bg-[#e8f3f2] text-[#0e1b19] text-sm font-bold"
            >
              Log Out
            </button>
          </form>

          <!-- Placeholder avatar -->
          <div
            class="w-10 h-10 bg-center bg-no-repeat bg-cover rounded-full"
            style="
              background-image: url('https://www.refugee-action.org.uk/wp-content/uploads/2016/10/anonymous-user.png');
            "
          ></div>
        </div>
      </header>

      <!-- Main Content -->
      <div class="px-40 flex flex-1 justify-center py-5">
        <div class="flex flex-col max-w-[960px] flex-1">
          <!-- Profile Section -->
          <div class="flex p-4">
            <div class="flex w-full flex-col gap-4 items-start">
              <div class="flex gap-4 flex-col items-start">
                <!-- Large Profile Picture -->
                <div
                  class="w-32 h-32 bg-center bg-no-repeat bg-cover rounded-full"
                  style="
                    background-image: url('https://www.refugee-action.org.uk/wp-content/uploads/2016/10/anonymous-user.png');
                  "
                ></div>
                <!-- Text Info -->
                <div class="flex flex-col justify-center">
                  <!-- Fills these via JavaScript -->
                  <p
                    id="profileName"
                    class="text-[#0e1b19] text-[22px] font-bold leading-tight tracking-[-0.015em]"
                  ></p>
                  <p id="profileEmail" class="text-[#4f968f] text-base"></p>
                  <p id="profileStats" class="text-[#4f968f] text-base"></p>
                </div>
              </div>
              <!-- Profile Action Buttons -->
              <div class="flex w-full max-w-[480px] gap-3">
                <button
                  class="flex flex-1 items-center justify-center rounded-full h-10 px-4 bg-[#e8f3f2] text-[#0e1b19] text-sm font-bold tracking-[0.015em]"
                >
                  Edit Profile
                </button>
                <button
                  class="flex flex-1 items-center justify-center rounded-full h-10 px-4 bg-[#1ce3cf] text-[#0e1b19] text-sm font-bold tracking-[0.015em]"
                >
                  Change Password
                </button>
              </div>
            </div>
          </div>

          <!-- Weekly Nutrition Plan Section -->
          <h2
            class="text-[#0e1b19] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5"
          >
            My Weekly Nutrition Plan
          </h2>
          <div class="p-4">
            <div class="flex items-stretch justify-between gap-4 rounded-xl">
              <div class="flex flex-col gap-4 flex-[2_2_0px]">
                <div class="flex flex-col gap-1">
                  <p class="text-[#4f968f] text-sm font-normal leading-normal">
                    Plan Start: December 13, 2024
                  </p>
                  <p class="text-[#0e1b19] text-base font-bold leading-tight">
                    Weekly Plan
                  </p>
                  <p class="text-[#4f968f] text-sm font-normal leading-normal">
                    View or delete your weekly nutrition plan
                  </p>
                </div>
                <button
                  class="flex items-center justify-center rounded-full h-8 px-4 bg-[#e8f3f2] text-[#0e1b19] text-sm font-medium leading-normal w-fit"
                >
                  View Plan
                </button>
              </div>
            </div>
          </div>

          <!-- Registered Recipes Section -->
          <h2
            class="text-[#0e1b19] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5"
          >
            Registered Recipes
          </h2>

          <!-- Recipe Card for Recipe 1 -->
          <div
            class="flex items-center gap-4 bg-[#f8fbfb] px-4 py-2 min-h-[72px] justify-between"
          >
            <div class="flex items-center gap-4">
              <div
                class="w-14 h-14 bg-center bg-no-repeat bg-cover rounded-lg"
                style="
                  background-image: url('https://t3.ftcdn.net/jpg/01/79/59/92/360_F_179599293_7mePKnajSM4bggDa8NkKpcAHKl3pow2l.jpg');
                "
              ></div>
              <div class="flex flex-col justify-center">
                <p class="text-[#0e1b19] text-base font-medium line-clamp-1">
                  Recipe 1
                </p>
                <p class="text-[#4f968f] text-sm line-clamp-2">
                  Added on: January 7, 2025
                </p>
              </div>
            </div>
            <div class="shrink-0">
              <div
                class="flex w-7 h-7 items-center justify-center text-[#0e1b19]"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24px"
                  height="24px"
                  fill="currentColor"
                  viewBox="0 0 256 256"
                >
                  <path
                    d="M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM96,40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96Zm96,168H64V64H192ZM112,104v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Z"
                  ></path>
                </svg>
              </div>
            </div>
          </div>

          <!-- Recipe Card for Recipe 2 -->
          <div
            class="flex items-center gap-4 bg-[#f8fbfb] px-4 py-2 min-h-[72px] justify-between mt-4"
          >
            <div class="flex items-center gap-4">
              <div
                class="w-14 h-14 bg-center bg-no-repeat bg-cover rounded-lg"
                style="
                  background-image: url('https://t3.ftcdn.net/jpg/01/79/59/92/360_F_179599293_7mePKnajSM4bggDa8NkKpcAHKl3pow2l.jpg');
                "
              ></div>
              <div class="flex flex-col justify-center">
                <p class="text-[#0e1b19] text-base font-medium line-clamp-1">
                  Recipe 2
                </p>
                <p class="text-[#4f968f] text-sm line-clamp-2">
                  Added on: February 1, 2025
                </p>
              </div>
            </div>
            <div class="shrink-0">
              <div
                class="flex w-7 h-7 items-center justify-center text-[#0e1b19]"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24px"
                  height="24px"
                  fill="currentColor"
                  viewBox="0 0 256 256"
                >
                  <path
                    d="M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM96,40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8v8H96Zm96,168H64V64H192ZM112,104v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0v64a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Z"
                  ></path>
                </svg>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Script for fetching and displaying user info -->
    <script>
      (async () => {
        try {
          const response = await fetch("/api/current-user");
          if (!response.ok) {
            console.warn("Could not fetch user data. Status:", response.status);
            return;
          }

          const userData = await response.json();

          const nameEl = document.getElementById("profileName");
          if (nameEl && userData.username) {
            nameEl.textContent = userData.username;
          }

          const emailEl = document.getElementById("profileEmail");
          if (emailEl && userData.email) {
            emailEl.textContent = userData.email;
          }

          const statsEl = document.getElementById("profileStats");
          if (statsEl) {
            const age = userData.age || "N/A";
            const height = userData.height || "N/A";
            const weight = userData.weight || "N/A";
            statsEl.textContent = `Age: ${age}, Height: ${height}, Weight: ${weight} lbs`;
          }
        } catch (error) {
          console.error("Error fetching current user:", error);
        }
      })();
    </script>
  </body>
  <!-- AI Chat Container -->
  <div id="ai-chat-container"></div>
  <script src="/dist/AI_Chat.bundle.js"></script>
</html>
